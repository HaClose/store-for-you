<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Store for you</title>
<link rel="icon" href="images/favicon.ico" sizes="16x16">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="You can get samples of Japanese items you want on Store fo you monthly! We send the Japanese items, skincare , cosmetics, hair care and so on. You can start at only USD15.00. Please try!!">
<meta name="keywords" content="store for you, subscription, cosme, skin care, hair care, Japan">
<link href="css/bootstrap.min.css" rel="stylesheet" type="text/css" media="all" />
<link href="https://fonts.googleapis.com/css?family=Open%20Sans:300,400,500,600,700" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="css/animate.css">
<!-- Resource style -->
<link rel="stylesheet" href="css/owl.carousel.css">
<link rel="stylesheet" href="css/owl.theme.css">
<link rel="stylesheet" href="css/ionicons.min.css">
<!-- Resource style -->
<link href="css/style.css" rel="stylesheet" type="text/css" media="all" />
<!-- Jquery and Js Plugins -->
<script type="text/javascript" src="js/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="js/bootstrap.min.js"></script>

<script type="text/javascript" src="js/plugins.js"></script>
<script type="text/javascript" src="js/menu.js"></script>
<script type="text/javascript" src="js/custom.js"></script>
<script src="js/jquery.subscribe.js"></script>
<script src="https://js.stripe.com/v3/"></script>
<script src="https://checkout.stripe.com/checkout.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-109698036-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-109698036-4');
</script>

<meta name="google-site-verification" content="akNF8z-DyNMWfZE3L6vnqFJsAGn_zvRTWECIG881DR4" />

</head>
<body onload="getParam()">
<div class="checkout_wrapper">
  <div class="container">
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button>
          <a class="navbar-brand page-scroll" href="https://store4ufm.com/"><img id="mayu-logo" src="images/storeforyou_logo.jpg" width="90" height="90" alt="storeforyou" /></a> </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse navbar-right" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav">
            <li><a class="page-scroll" href="https://store4ufm.com/concept">Concept</a></li>
            <li><a class="page-scroll" href="https://www.beautyboxjapan.com/">Beauty Box Japan</a></li>
            <li><a class="page-scroll" href="https://www.beautyboxjapan.com/about/">about us</a></li>
            <li><a class="page-scroll" href="https://www.beautyboxjapan.com/contact-us/">Contact</a></li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- /.navbar-collapse -->
  </div>
  <!-- /.container-fluid -->
  <div class="main app form" id="main"><!-- Main Section-->
    <div class="content-body-checkout">
    <h1 class="page_title">
      Checkout page
    </h1>
    <h2 class="section_title">
        Your selected Items
    </h2>
    <form name="selectedProductsForm" id="payment-form" method="post" action="start_subscription.php">
      <input type="text" name="selectedProducts" class="products_form" size="65" readonly="readonly">
      <div id="card-errors" role="alert"></div>
    <div class="checkout_form">
      <h2 class="section_title">
        Billing and shipping details
      </h2>
      <h3 class="form_title">
        First name<br>
      </h3>
        <input type="text" id="customerFirstName" class="form" placeholder="First name">
      <h3 class="form_title">
        Last name<br>
      </h3>
        <input type="text" id="customerLastName" class="form" placeholder="Last name">
      <h3 class="form_title">
        Country<br>
      </h3>
        <input type="text" id="customerCountry" class="form" placeholder="Country">
      <h3 class="form_title">
        Address<br>
      </h3>
        <input type="text" id="customerAddress" class="form" placeholder="Address">
      <h3 class="form_title">
        State<br>
      </h3>
        <input type="text" id="customerState" class="form" placeholder="State">
      <h3 class="form_title">
        Postcode / ZIP<br>
      </h3>
        <input type="text" id="customerPostcode" class="form" placeholder="Postcode / ZIP">
      <h3 class="form_title">
        Phone number<br>
      </h3>
        <input type="text" id="customerPhoneNumber" class="form" placeholder="Phone number">
      <h3 class="form_title">
        Email address<br>
      </h3>
        <input type="text" id="customerEmail" class="form" placeholder="Email address">
    </div>
    <div class="checkout_form_card">
      <h2 class="section_title">
        Credit Card (Stripe)
      </h2>
      <h3 class="form_title">
        Card Number<br>
      </h3>
        <!--<input type="text" id="customerCardNumber" class="form" placeholder="Card Number">-->
        <div id="card-number" class="stripe-input"></div>
      <h3 class="form_title">
        Expiry Date<br>
      </h3>
        <!--<input type="text" id="customerExpiryDate" class="form" placeholder="Expiry Date">-->
        <div id="card-expiry" class="stripe-input"></div>
      <h3 class="form_title">
        Card Code (CVC)<br>
      </h3>
        <!--<input type="text" id="customerCVC" class="form" placeholder="CVC">-->
        <div id="card-cvc" class="stripe-input"></div>
    </div>
  </form>
  <diV class="announce_checkout">
    Price : RM60.00<br>
    (Now the first month payment is half price!)<br>
    Pay with your credit card via Stripe
   </div>
  <div class="order">
    <input type="submit" id="orderbutton" class="btn btn-primary btn-action btn-fill" value="Place Order">
    <p id="complete"></p>
  </div>


      <!-- <a id="back-top" class="back-to-top page-scroll" href="#main"> <i class="ion-ios-arrow-thin-up"></i> </a>-->
    <!-- Scroll To Top Ends-->
  </div>

    <div class="footer">
      <ul>
        <div class="footer_menue">
          <li class="footer_contents"><a href="https://www.beautyboxjapan.com/store-for-you-terms-of-service/">Terms of service</a></li>
          <li class="footer_contents"><a href="https://www.beautyboxjapan.com/privacy-policy/">Privacy Policy</a></li>
        </div>
        <li class="copyright">
        © 2020 HaClose Inc,. All Rights Reserve
        </li>
      </ul>
    </div>

  </div> <!-- Main Section -->
</div>
<!-- Wrapper-->
<!-- Checkout start -->
<script>
  let param = '';
  const publicKey = 'pk_test_3LYqp76Baj0Z7WuetsAQEJFc';
  var stripe = Stripe(publicKey);
  var elements = stripe.elements();
  const cardNumber = elements.create('cardNumber',{placeholder:'1111 1111 1111 1111'});
  cardNumber.mount('#card-number');
  const cardExpiry = elements.create('cardExpiry',{placeholder:'MM/YY'});
  cardExpiry.mount('#card-expiry');
  const cardCvc = elements.create('cardCvc',{placeholder:'111'});
  cardCvc.mount('#card-cvc');
  let customerName = '';
  let customerEmail = '';

  function getParam(){
    param = location.search;
    if (!param) return false;
    param = param.substring(1);
    param = param.split("=");
    document.selectedProductsForm.selectedProducts.value = param[1];
  }

  document.getElementById("orderbutton").onclick = function(e) {
    const request = new XMLHttpRequest();
    customerName = document.getElementById("customerFirstName").value + document.getElementById("customerLastName").value;
    customerEmail = document.getElementById("customerEmail").value;

    request.open('POST', 'https://hooks.slack.com/services/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',false);
    request.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
    //request.send('payload={\"channel\": \"#order\", \"username\": \"' + customerName + '\", \"text\": \"1,2,3,4,5,6,7,8,9\", \"icon_emoji\": \":ghost:\"}');
    request.send('payload={\"channel\": \"#order\", \"username\": \"' + customerName + '\", \"text\": \"Email=' + customerEmail + ',selectedProducts=' + param + '\", \"icon_emoji\": \":ghost:\"}');
    if(request.status === 200) {

    // Stripeサーバにクレジットカード情報を送信してクレジットカードトークンを取得する
    stripe.createToken(cardNumber).then(function(result) {
        if (result.error) {
            var errorElement = document.getElementById('card-errors');
            errorElement.textContent = result.error.message;
        } else {
            // クレジットカードトークンを自サーバにsubmitする
            stripeTokenHandler(result.token);
        }
    });

    function stripeTokenHandler(token) {
    var form = document.getElementById('payment-form');
    var hiddenInput = document.createElement('input');
    hiddenInput.setAttribute('type', 'hidden');
    hiddenInput.setAttribute('name', 'stripeToken');
    hiddenInput.setAttribute('value', token.id);
    form.appendChild(hiddenInput);

    form.submit();
    }
  }

    $(function() {
      $('#orderbutton').on('sumbit', function() {
        // 1．textメソッドで書き換え
        $("#complete").text("Thank you for your placing an order. Our staff will send confirmation email to you!");

        //$("#complete").delay(1000).slideUp('slow');
      });
    });
  }
</script>

<!-- Checkout end -->
</body>
</html>
